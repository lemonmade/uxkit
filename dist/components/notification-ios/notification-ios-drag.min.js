var $event=$.event,$specialEvent=$event.special,drag;drag=$specialEvent.drag={settings:{related:0,distance:10,click:!1,cursor:!0},handlers:{dragstart:null,drag:null,dragend:null},dragging:!1,key:"uxdragdata",touches:0,setup:function(a){var b=$(this);if(!b.data(drag.key)){var c=$.extend(drag.settings,a);b.data(drag.key,c),c.cursor&&b.css("cursor","pointer"),b.on("touchstart.drag mousedown.drag",c,drag.starter)}},teardown:function(){$(this).data(drag.key,""),$this.css("cursor",""),this.off("touchstart.drag mousedown.drag"),drag.setTextSelectability(!0)},add:function(a){var b=$(this).data(drag.key);b.related+=1,drag.handlers[a.type]=a.handler,$.extend(b,a.data||{})},remove:function(){$.data(this,drag.key).related-=1},_default:function(){},starter:function(a){if(!drag.touches){drag.touches="touchstart"==a.type?1:0,drag.setTextSelectability(!1);var b=$(this).data(drag.key);drag.check.anyFalse(!drag.touches&&1!=a.which,b.handle&&$(a.target).closest(b.handle,a.currentTarget).length<1)&&(b.target=a.target,b.pageX=a.originalEvent.pageX,b.pageY=a.originalEvent.pageY,drag.touches?$(this).on("touchmove.drag touchend.drag",b,drag.handler):$(document).on("mousemove.drag mouseup.drag",b,drag.handler))}},handler:function(a){var b=a.data;if(b)switch(a.type){case"touchmove":case"mousemove":a.preventDefault(),drag.configureEvent(a,b),!drag.dragging&&a.distance>b.distance?(drag.dragging=!0,drag.dispatchEvent("dragstart",a,this)):drag.dragging&&drag.dispatchEvent("drag",a,this);break;case"touchend":case"mouseup":drag.configureEvent(a,b),drag.dragging=!1,drag.dispatchEvent("dragend",a,this),$(document).off("mousemove.drag mouseup.drag"),drag.touches=0}},configureEvent:function(a,b){a.deltaX=a.originalEvent.pageX-b.pageX,a.deltaY=a.originalEvent.pageY-b.pageY,a.distance=Math.sqrt(Math.pow(Math.abs(a.deltaX),2)+Math.pow(Math.abs(a.deltaY),2))},dispatchEvent:function(a,b,c){drag.handlers[a]&&(b.type=a,b.originalEvent=null,drag.handlers[a].apply(c,[b]))},setTextSelectability:function(a){a?($(document).off("selectstart").css("MozUserSelect",""),document.unselectable=!1):($(document).on("selectstart",function(){return!1}).css("MozUserSelect","false"),document.unselectable=!0)},check:{anyFalse:function(){for(var a=0;a<arguments.length;a++)if(!arguments[a])return!0;return!1},allFalse:function(){for(var a=0;a<arguments.length;a++)if(arguments[a])return!1;return!0}}},$specialEvent.dragstart=$specialEvent.dragend=drag,function(){var a,b,c,d,e,f=[].slice;a=function(){function a(){var c,d,e,g,h,i,j,k,l,m,n;j=arguments[0],h=3<=arguments.length?f.call(arguments,1,n=arguments.length-1):(n=1,[]),m=arguments[n++],null==m&&(m={}),m instanceof b&&(h.push(m),m={}),i={container:".notification-device:first",activate:!0,draggable:!0},m=$.extend(i,m),j instanceof jQuery?(this.notification=j,this.wrapper=j.find(".notification-wrapper"),this.handle=j.find(".notification-handle"),this.actions=j.find(".notification-actions")):(k=a.messageTemplate,e=void 0,toString.call(j).match(/String/i)?(k=k.replace("BODY",j),e=$(k),e.find(".notification-title").remove()):(k=k.replace(/(BODY|TITLE)/,function(a){return j[a.toLowerCase()]}),e=$(k)),console.log(toString.call(j)),g=$(a.template),g.find(".notification-content").append(e),c=g.find(".notification-actions"),h.forEach(function(a){return function(b){return a._attachDefaultBehaviors(b),c.append(b.action)}}(this)),null!=m.container&&(d=$(m.container)).length>0&&d.append(g),this.notification=g,this.wrapper=g.find(".notification-wrapper"),this.handle=g.find(".notification-handle"),this.actions=c),m.draggable&&this.makeDraggable(),m.activate&&(l=this,setTimeout(function(){return l.activate()},50))}return a.prototype.dismiss=function(){return this.notification.removeClass("interacting dragging active")},a.prototype.activate=function(){return this.wrapper.css("padding-bottom",""),this.actions.css("opacity",""),this.handle.css("opacity",""),this.notification.addClass("active").css("transform","")},a.prototype.makeDraggable=function(){var a,b,c,d,e,f,g,h,i,j,k;return k=this,h=this.notification,a=this.actions,b=this.handle,c=this.wrapper,d=a.outerHeight(),j=parseFloat(c.css("padding-bottom")),e=d-j,i=void 0,f=0,g=parseFloat(h.css("padding-top")),h.on("dragstart",function(){return h.addClass("dragging")}),h.on("drag",function(d){var l,m;return h.hasClass("interacting")?(m=k._dragEaseOut(d.deltaY),h.css("transform","translateY("+Math.min(g,m)+"px)")):(null==i&&(i=d.deltaY),l=Math.max(Math.min(1,(d.deltaY-i)/e),0),f!==l?(f=l,a.css("opacity",l),b.css("opacity",1-l),c.css("padding-bottom",""+(j+l*e)+"px")):1===l?(m=k._dragEaseOut(d.deltaY-i-e),h.css("transform","translateY("+Math.min(m,g)+"px)")):void 0)}),h.on("dragend",function(){var d;return h.removeClass("dragging").css("transform",""),1>f?(a.css("opacity",""),b.css("opacity",""),c.css("padding-bottom","")):(h.addClass("interacting"),(d=a.find("input[type=text]")).length>0?d.focus():void 0)})},a.prototype.switchActions=function(){var a,b,c;return c=1<=arguments.length?f.call(arguments,0):[],a=$("<div class='notification-actions' />"),c.forEach(function(b){return function(c){return b._attachDefaultBehaviors(c),a.append(c.action)}}(this)),b=this.actions,this.actions=a,a.insertAfter(b),b.addClass("switching-out"),setTimeout(function(){var b,d,e,f,g;for(a.addClass("switching-in"),g=[],d=e=0,f=c.length;(f>=0?f>=e:e>=f)&&!(b=c[d].focus());d=f>=0?++e:--e)g.push(void 0);return g},50)},a.prototype._dragEaseOut=function(a){return 1.2*Math.pow(a,.6)},a.prototype._attachDefaultBehaviors=function(a){var c,d;return d=a.textAction,c=this,"button"===a.type?a.input.on("click",function(b){return a.callback(b,c)}):"submit"===a.type?a.input.on("click",function(e){var f;return f="",f=d instanceof b?d.input.val():null!=d?d.find("input[type=text]").val():void 0,e.text=f,a.callback(e,c)}):void 0},a}(),a.template="<div class='notification-ios'> <div class='notification-wrapper'> <div class='notification-content'></div> <div class='notification-actions'></div> <div class='notification-handle'></div> </div> </div>",a.messageTemplate="<div class='notification-icon'></div> <div class='notification-message'> <h3 class='notification-title'>TITLE</h3> <p class='notification-body'>BODY</p> </div>",b=function(){function a(b){var c,d,e,f;d={type:"button",label:"Button",placeholder:"Message",id:"","class":"",textAction:void 0,callback:function(){}},b=$.extend(d,b),c="",b["class"].length>0&&(c+=" class = '"+b["class"]+"'"),b.id.length>0&&(c+=" id = '"+b.id+"'"),f=function(){switch(b.type){case"button":return"<button"+c+">"+b.label+"</button>";case"submit":return"<input"+c+" type='submit' value='"+b.label+"'>";case"text":return"<input"+c+" type='text' placeholder='"+b.placeholder+"'>";default:return""}}(),e=a.template.replace(/(TYPE|ELEMENT)/g,function(a){switch(a){case"TYPE":return b.type;case"ELEMENT":return f}}),this.action=$(e),this.input=this.action.children(),this.type=b.type,this.textAction=b.textAction,this.callback=b.callback}return a.prototype.focus=function(){return this.type===c.textField?(this.input.trigger("focus"),!0):!1},a}(),b.template="<div class='notification-action TYPE'>ELEMENT</div>",c=function(){function a(){}return a}(),c.button="button",c.submitButton="submit",c.textField="text",window.Notification=a,window.NotificationAction=b,window.NotificationActionType=c,d=function(a){return alert("You pressed button '"+$(a.target).text()+"'!")},e=function(a){return console.log(a.text)},window.na1=new b(d,{type:"text",placeholder:"Your Message Here"}),window.na2=new b(e,{type:"submit",label:"Send",textAction:na1}),window.na3=new b(d,{type:"button",label:"Button 1"}),window.na4=new b(d,{type:"button",label:"Button 2"}),$(function(){var d,e,f,g;return $(".notification-ios:first").remove(),d=new b({type:c.button,label:"Mark as Read",callback:function(){return alert("You marked the message as read.")}}),f=new b({type:c.button,label:"View",callback:function(){}}),e=new b({type:c.button,label:"Reply",callback:function(){var a,d;return a=new b({type:c.textField}),d=new b({type:c.submitButton,label:"Send",textAction:a,callback:function(a,b){return alert(a.text),b.dismiss()}}),g.switchActions(a,d)}}),g=new a("Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ratione est cupiditate minima ea voluptatem accusantium quia, nobis earum ipsum voluptas.",d,f,e),setTimeout(function(){return g.activate()},2e3)})}.call(this);