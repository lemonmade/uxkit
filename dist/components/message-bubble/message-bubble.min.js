function Message(a){this[0]=a,this.timestamp=a.data("message-timestamp")}function MessageController(a){var b=$(".message-bubble-container");a=a||{},this.container=a.container?$(a.container):b.length>0?b:$("body"),this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner"> MESSAGE<svg class="message-bubble-whale-tail" width="116px" height="119px" viewBox="0 0 116 119" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 116 119" xml:space="preserve"><path fill="#A0A0A0" d="M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z" id="Shape" sketch:type="MSShapeGroup"></path></svg>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=void 0!==a.automateDateSections?a.container:!0,this.dateSectionCutoff=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}function Message(a){this[0]=a,this.timestamp=a.data("message-timestamp")}function MessageController(a){var b=$(".message-bubble-container");a=a||{},this.container=a.container?$(a.container):b.length>0?b:$("body"),this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner"> MESSAGE<svg class="message-bubble-whale-tail" width="116px" height="119px" viewBox="0 0 116 119" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 116 119" xml:space="preserve"><path fill="#A0A0A0" d="M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z" id="Shape" sketch:type="MSShapeGroup"></path></svg>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=void 0!==a.automateDateSections?a.container:!0,this.dateSectionCutoff=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}(function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),(c.append instanceof jQuery||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),c.append=!0),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount+1),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=$(),c=this,this.getSubsetOfMessages(a).each(function(){var a;return a=$(this),c.checkForSectionRemovalAndRemove(a),b=b.add(a)}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b=b.add(d)):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a}(),window.MessageController=a}).call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),(c.append instanceof jQuery||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),c.append=!0),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount+1),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=$(),c=this,this.getSubsetOfMessages(a).each(function(){var a;return a=$(this),c.checkForSectionRemovalAndRemove(a),b.add(a)}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b.add(d)):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),(c.append instanceof jQuery||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),(c.append instanceof jQuery||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),(c.append instanceof jQuery||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a
},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),(c.append instanceof jQuery||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),(c.append instanceof jQuery||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),(c.append instanceof jQuery||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),(c.append instanceof jQuery||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,console.log(f.attr("class")),k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),console.log(typeof c.append),(typeof c.append===jQuery||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,console.log(f.attr("class")),k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()
},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),(typeof c.append===jQuery||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),console.log(c.container),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,console.log(f.attr("class")),k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),("jQuery"==typeof c.append||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),console.log(c.container),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,console.log(f.attr("class")),k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),("jQuery"==typeof c.append||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),console.log(c.container),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,console.log(f.attr("class")),k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),("jQuery"==typeof c.append||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,console.log(f.attr("class")),k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),(typeof c.append===jQuery||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,console.log(f.attr("class")),k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")
},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),(typeof c.append===jQuery||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b;b=864e5,a=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==c&&(c={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},c=$.extend(n,c),(typeof c.append===jQuery||"[object String]"===Object.prototype.toString.call(c.append))&&(c.container=$(c.append),c.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),c.timestamp&&(p=null!=c.artificialDate?new Date(c.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),c.tail||j.addClass("no-tail"),c.reply&&j.addClass("reply"),null!=c.inReplyTo&&(l=$(c.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),c.after?(d=$(c.after)).length>0&&j.insertAfter(d):c.before?(e=$(c.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=c.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/b),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/b),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=c.container?$(c.container):this.container,k=f.children(c.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[c.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=a}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE <svg class='message-bubble-whale-tail' width='116px' height='119px' viewBox='0 0 116 119' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' enable-background='new 0 0 116.42 97.35' xml:space='preserve'> <path fill='#A0A0A0' d='M67.39,79.03 C84.24,104.95 116.42,115.32 116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z'></path> </svg> </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},b=$.extend(n,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(l=$(b.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML="<div class='message-bubble'> <div class='message-bubble-inner'> MESSAGE </div> </div>",this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},b=$.extend(n,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(l=$(b.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},b=$.extend(n,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(l=$(b.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)
})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},b=$.extend(n,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(l=$(b.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},b=$.extend(n,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(l=$(b.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},b=$.extend(n,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(l=$(b.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(n,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(l=$(b.inReplyTo)).length>0&&(console.log("HERE"),j[l.hasClass("reply")?"removeClass":"addClass"]("reply")),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(n,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),console.log(b.reply),console.log(b.replyTo),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(l=$(b.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(n,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(l=$(b.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b
},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(n,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(l=$(b.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(n,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(l=$(b.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),console.log(j.attr("class")),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(n,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(l=$(b.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(n,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(l=$(b.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),n={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(n,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(l=$(b.inReplyTo)).length>0&&j[l.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),m=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),o=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),m-o>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)
})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),m={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(m,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(o=$(b.inReplyTo)).length>0&&j[o.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),l=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),n=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),l-n>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=864e5,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),m={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(m,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(o=$(b.inReplyTo)).length>0&&j[o.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),l=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),n=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),l-n>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,console.log(g),this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=c,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML='<div class="message-bubble"><div class="message-bubble-inner">MESSAGE </div></div>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),m={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(m,b),(typeof b.append===jQuery||"[object String]"===Object.prototype.toString.call(b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(o=$(b.inReplyTo)).length>0&&j[o.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),l=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),n=Math.floor(new Date(i.data(this.timestampKey)).getTime()/c),l-n>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,console.log(g),this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:"")+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=c,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML=' <div class="message-bubble"><div class="message-bubble-inner"> MESSAGE\n <svg class="message-bubble-whale-tail" width="116px" height="119px"\nviewBox="0 0 116 119" version="1.1" xmlns="http://www.w3.org/2000/svg"\nxmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 116 119"\nxml:space="preserve"><path fill="#A0A0A0" d="M67.39,79.03 C84.24,104.95 116.42,115.32\n116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-\n0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z"\nid="Shape" sketch:type="MSShapeGroup"></path></svg>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),m={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(m,b),(typeof b.append===jQuery||Object.prototype.toString.call("[object String]"===b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(o=$(b.inReplyTo)).length>0&&j[o.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),l=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),n=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),l-n>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:void 0)+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}(),window.MessageController=b}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=c,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML=' <div class="message-bubble"><div class="message-bubble-inner"> MESSAGE\n <svg class="message-bubble-whale-tail" width="116px" height="119px"\nviewBox="0 0 116 119" version="1.1" xmlns="http://www.w3.org/2000/svg"\nxmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 116 119"\nxml:space="preserve"><path fill="#A0A0A0" d="M67.39,79.03 C84.24,104.95 116.42,115.32\n116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-\n0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z"\nid="Shape" sketch:type="MSShapeGroup"></path></svg>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),m={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(m,b),(typeof b.append===jQuery||Object.prototype.toString.call("[object String]"===b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(o=$(b.inReplyTo)).length>0&&j[o.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),l=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),n=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),l-n>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b,c;return b=0,c=this,this.getSubsetOfMessages(a).each(function(){return c.checkForSectionRemovalAndRemove($(this)),b++}),b>0||this.messages.each(function(){var d;return d=$(this),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b,c;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this,b.each(function(){var a,b,d;return a=$(this),d=a.data(c.timestampKey),b=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(d)+"</span>"):void 0})},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:void 0)+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}()}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=c,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML=' <div class="message-bubble"><div class="message-bubble-inner"> MESSAGE\n <svg class="message-bubble-whale-tail" width="116px" height="119px"\nviewBox="0 0 116 119" version="1.1" xmlns="http://www.w3.org/2000/svg"\nxmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 116 119"\nxml:space="preserve"><path fill="#A0A0A0" d="M67.39,79.03 C84.24,104.95 116.42,115.32\n116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-\n0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z"\nid="Shape" sketch:type="MSShapeGroup"></path></svg>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),m={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(m,b),(typeof b.append===jQuery||Object.prototype.toString.call("[object String]"===b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(o=$(b.inReplyTo)).length>0&&j[o.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),l=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),n=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),l-n>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j
},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b;return b=0,this.getSubsetOfMessages(a).each(function(a){return function(){return a.checkForSectionRemovalAndRemove($(a)),b++}}(this)),b>0||this.messages.each(function(c){return function(){var d;return d=$(c),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}}(this)),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),b.each(function(a){return function(){var b,c,d;return b=$(a),d=b.data(a.timestampKey),c=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?b.append("<span class='message-bubble-timestamp'>"+a.formatDateString(d)+"</span>"):void 0}}(this))},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:void 0)+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}()}.call(this),function(){var a,b,c;a=function(){function a(a){this[0]=a,this.timestamp=a.data("message-timestamp")}return a}(),c=c,b=function(){function a(a){var b;null==a&&(a={}),b=$(".message-bubble-container"),b.length<1&&(b=$("body")),this.container=null!=a.container?a.container:b,this.messages=$(".message-bubble"),this.messageBubbleHTML=' <div class="message-bubble"><div class="message-bubble-inner"> MESSAGE\n <svg class="message-bubble-whale-tail" width="116px" height="119px"\nviewBox="0 0 116 119" version="1.1" xmlns="http://www.w3.org/2000/svg"\nxmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 116 119"\nxml:space="preserve"><path fill="#A0A0A0" d="M67.39,79.03 C84.24,104.95 116.42,115.32\n116.42,115.32 C116.42,115.32 73.88,124.39 46.66,115.32 C19.44,106.24 0,79.03 0,79.03 L0,-\n0.227279902 L51.8400002,-0.227279902 L51.84,22 C51.84,22 50.54,53.1 67.39,79.03 Z"\nid="Shape" sketch:type="MSShapeGroup"></path></svg>',this.messageDateSectionHTML="<section class='message-bubble-date-section' />",this.timestampKey="message-timestamp",this.automateDateSections=null!=a.automateDateSections?a.automateDateSections:!0,this.dateSectionCutoff=null!=a.dateSectionCutoff?a.dateSectionCutoff:"unique-day"}return a.prototype.setBackgroundColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){var b;return b=$(this),b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},a.prototype.setTextColor=function(a,b){return this.getSubsetOfMessages(b).each(function(){return $(this).css("color",a)})},a.prototype.getSubsetOfMessages=function(a){return null==a?this.messages:this.messages.filter(function(){return $(this).is(a)})},a.prototype.update=function(){return this.messages=$(".message-bubble")},a.prototype.newMessage=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;return null==b&&(b={}),m={after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:!0,reply:!1},b=$.extend(m,b),(typeof b.append===jQuery||Object.prototype.toString.call("[object String]"===b.append))&&(b.container=$(b.append),b.append=!0),j=$(this.messageBubbleHTML.replace("MESSAGE",a)),b.timestamp&&(p=null!=b.artificialDate?new Date(b.artificialDate):new Date,j.attr("data-"+this.timestampKey,p.getTime()),this.timestamp(j)),b.tail||j.addClass("no-tail"),b.reply&&j.addClass("reply"),null!=b.inReplyTo&&(o=$(b.inReplyTo)).length>0&&j[o.hasClass("reply")?"removeClass":"addClass"]("reply"),b.after?(d=$(b.after)).length>0&&j.insertAfter(d):b.before?(e=$(b.before)).length>0&&j.insertBefore(e):this.automateDateSections&&null!=b.timestamp&&this.messages.length>0?(i=this.messages.last(),l=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),n=Math.floor(new Date(j.data(this.timestampKey)).getTime()/c),l-n>=1?(g=(h=i.closest(".message-bubble-date-section")).length>0?h:i,this.makeQuickDateSection(j).insertAfter(g)):j.insertAfter(i)):(f=null!=b.container?$(b.container):this.container,k=f.children(b.append?":last-child":":first-child"),k.hasClass("message-bubble-date-section")&&(f=k),j[b.append?"appendTo":"prependTo"](f)),this.update(),j},a.prototype.add=function(a,b){return this.newMessage(a,b)},a.prototype.makeDateSection=function(a){var b,c,d,e,f,g;return null==a&&(a={}),e={startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a=$.extend(e,a),d=this.messages,a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,d),null!=a.endMessage?a.endMessage=1+this.convertPossibleSelectorToIndexNumber(a.endMessage,d):a.messageCount&&(a.endMessage=a.startMessage+a.messageCount),(null==a.endMessage||0>(g=a.endMessage)&&g>d.length)&&(a.endMessage=d.length),c=d.slice(a.startMessage-1,a.endMessage),this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML),b=c.parent(),f="<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+(a.sectionHeadingDate||this.weekdayString(c.first().data(this.timestampKey)))+" </span> "+(a.sectionHeadingTime?a.sectionHeadingTime:null==a.sectionHeadingDate?this.formatDateString(c.first().data(this.timestampKey)):void 0)+" </h3>",$(f).prependTo(b),b},a.prototype.makeQuickDateSection=function(a){var b,c;return b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey),this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'> <span class='message-bubble-date'> "+this.weekdayString(c)+" </span> "+this.formatDateString(c)+" </h3>").prependTo(b),b},a.prototype.destroyOverlappingSections=function(a){return a.each(function(){var a,b;return b=$(this),a=b.parent(),a.hasClass("message-bubble-date-section")?(a.children(".message-bubble-heading").remove(),b.unwrap()):void 0})},a.prototype.convertPossibleSelectorToIndexNumber=function(a,b){return null==a?null:"number"!=typeof a&&(a=$(a),a=b.index(a),0>a)?null:a},a.prototype.removeMessage=function(a){var b;return b=0,this.getSubsetOfMessages(a).each(function(a){return function(){return a.checkForSectionRemovalAndRemove($(a)),b++}}(this)),b>0||this.messages.each(function(c){return function(){var d;return d=$(c),d.text().match(a)?(c.checkForSectionRemovalAndRemove(d),b++):void 0}}(this)),this.update(),b},a.prototype.remove=function(a){return this.removeMessage(a)},a.prototype["delete"]=function(a){return this.removeMessage(a)},a.prototype.checkForSectionRemovalAndRemove=function(a){return a.parent().hasClass("message-bubble-date-section"&&a.siblings(".message-bubble").length<1)?a.parent().remove():a.remove()},a.prototype.timestamp=function(a){var b;return b=a instanceof jQuery?a:this.getSubsetOfMessages(a),b.each(function(a){return function(){var b,c,d;return b=$(a),d=b.data(a.timestampKey),c=new Date(d),d&&!(new Date(d)+"").match(/Invalid/gi)?b.append("<span class='message-bubble-timestamp'>"+a.formatDateString(d)+"</span>"):void 0}}(this))},a.prototype.formatDateString=function(a){var b,c,d,e;return a=new Date(a),e=[a.getHours(),a.getMinutes()],c=e[0],d=e[1],b=c%12!==0?c%12:12,""+b+":"+(10>d?0:void 0)+d+" "+(12>c?"AM":"PM")},a.prototype.weekdayString=function(a){var b;if(a=new Date(a),b=new Date,a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDay()===b.getDay())return"Today";switch(a.getDay()){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";default:return"Saturday"}},a}()}.call(this),MessageController.prototype={setBackgroundColor:function(a,b){this.getSubsetOfMessages(b).each(function(){var b=$(this);b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},setTextColor:function(a,b){this.getSubsetOfMessages(b).each(function(){var b=$(this);b.css("color",a)})},getSubsetOfMessages:function(a){return a?this.messages.filter(function(){return $(this).is(a)}):this.messages},update:function(){this.messages=$(".message-bubble")},newMessage:function(a,b){var b=$.extend({after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},b);"[object String]"==Object.prototype.toString.call(b.append)&&(b.container=$(b.append),b.append=!0);var c=$(this.messageBubbleHTML.replace("MESSAGE",a));if(b.timestamp){var d=(null!==b.artificialDate?new Date(b.artificialDate):new Date).getTime();c.attr("data-"+this.timestampKey,d),this.timestamp(c)}if(b.tail||c.addClass("no-tail"),b.reply&&c.addClass("reply"),b.inReplyTo&&(b.inReplyTo.hasClass("reply")?c.removeClass("reply"):c.addClass("reply")),b.after){var e=$(b.after);e.length>0&&c.insertAfter(e)}else if(b.before){var f=$(b.before);f.length>0&&c.insertBefore(f)}else if(this.automateDateSections&&b.timestamp&&this.messages.length>0){var g=Math.floor(new Date(c.data(this.timestampKey)).getTime()/864e5),h=this.messages.last(),i=Math.floor(new Date(h.data(this.timestampKey)).getTime()/864e5);if(g-i>=1){var j=h,k=h.closest(".message-bubble-date-section");k.length>0&&(j=k),this.makeQuickDateSection(c).insertAfter(j)}else c.insertAfter(h)}else{var l=b.container?$(b.container):this.container,m=l.children(b.append?":last-child":":first-child");m.hasClass("message-bubble-date-section")&&(l=m),c[b.append?"appendTo":"prependTo"](l)}return this.update(),c},add:function(a,b){return this.newMessage(a,b)},makeDateSection:function(a){var a=$.extend({startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a),b=this.messages;a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,b),a.endMessage?a.endMessage=this.convertPossibleSelectorToIndexNumber(a.endMessage,b)+1:a.messageCount&&(a.endMessage=startMessage+messageCount),a.endMessage||(a.endMessage=b.length);var c=b.slice(a.startMessage-1,a.endMessage);this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML);var d=c.parent(),e="<h3 class='message-bubble-heading'><span class='message-bubble-date'>";return e+=a.sectionHeadingDate?a.sectionHeadingDate:this.weekdayString(c.first().data(this.timestampKey)),e+="</span>",a.sectionHeadingTime?e+=" "+a.sectionHeadingTime:a.sectionHeadingDate||(e+=" "+this.formatDateString(c.first().data(this.timestampKey))),e+="</h3>",$(e).prependTo(d),d},makeQuickDateSection:function(a){var b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey);return this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'><span class='message-bubble-date'>"+this.weekdayString(c)+"</span> "+this.formatDateString(c)+"</h3>").prependTo(b),b},destroyOverlappingSections:function(a){a.each(function(){var a=$(this),b=a.parent();b.hasClass("message-bubble-date-section")&&(b.children(".message-bubble-heading").remove(),a.unwrap())})},convertPossibleSelectorToIndexNumber:function(a,b){return a?"number"!=typeof a&&("[object String]"==Object.prototype.toString.call(a)&&(a=$(a)),a=b.index(a),0>a)?null:a:null},removeMessage:function(a){var b=0,c=this.getSubsetOfMessages(a),d=this;b=c.length,c.each(function(){d.checkForSectionRemovalAndRemove($(this))});var e;return 1>b&&$(".message-bubble").each(function(){e=$(this),e.text().match(a)&&(d.checkForSectionRemovalAndRemove(e),b++)}),this.update(),b},remove:function(a){return this.removeMessage(a)},"delete":function(a){return this.removeMessage(a)},checkForSectionRemovalAndRemove:function(a){a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},timestamp:function(a){var b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this;b.each(function(){var a=$(this),b=a.data(c.timestampKey);new Date(b),b&&!(new Date(b)+"").match(/Invalid/gi)&&a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(b)+"</span>")})},formatDateString:function(a){a=new Date(a);var b=a.getHours(),c=a.getMinutes(),d=b%12!=0?b%12:12;return d+":"+(10>c?"0"+c:c)+" "+(b>=12?"PM":"AM")},weekdayString:function(a){a=new Date(a);var b=new Date;if(a.getYear()==b.getYear()&&a.getMonth()==b.getMonth()&&a.getDay()==b.getDay())return"Today";var c;switch(a.getDay()){case 0:c="Sunday";break;case 1:c="Monday";break;case 2:c="Tuesday";break;case 3:c="Wednesday";break;case 4:c="Thursday";break;case 5:c="Friday";break;default:c="Saturday"}return c}},$(document).ready(function(){var a=new MessageController;a.timestamp(),a.add("Sample message 1");var b=a.add("Sample message 2"),c=a.add("Sample message 3",{inReplyTo:b,artificialDate:(new Date).getTime()+8e7});a.add("Sample message 4",{inReplyTo:c,artificialDate:(new Date).getTime()+16e7}),a.add("Sample message 5",{reply:!0,artificialDate:(new Date).getTime()+166e6});var d=$(".message-bubble-container"),e=$(".message-bubble-timestamp").first().outerWidth();d.on("dragstart",function(){$(".message-bubble").removeClass("return")}),d.on("dragend",function(){$(".message-bubble").addClass("return").css("transform","translateX(0)"),$(".message-bubble-timestamp").css("opacity",0);var a=d.outerWidth()-parseFloat(d.css("padding-left"))-parseFloat(d.css("padding-right"));$(".message-bubble.reply").each(function(){var b=$(this);b.find(".message-bubble-timestamp").css("transform","translate("+(a-b.outerWidth())+"px, -50%)")})}),d.on("drag",function(a){$(".message-bubble:not(.reply)").css("transform","translateX("+Math.max(a.deltaX,-e)+"px)"),$(".message-bubble-timestamp").css("opacity",Math.max(0,a.deltaX/-e));var b=$(".message-bubble-container"),c=b.outerWidth()-parseFloat(b.css("padding-left"))-parseFloat(b.css("padding-right"));$(".message-bubble.reply").each(function(){var b=$(this);b.find(".message-bubble-timestamp").css("transform","translate("+(c-b.outerWidth()-Math.min(e,-a.deltaX))+"px, -50%)")})})}),MessageController.prototype={setBackgroundColor:function(a,b){this.getSubsetOfMessages(b).each(function(){var b=$(this);b.css("background-color",a),b.find(".message-bubble-whale-tail path").css("fill",a)})},setTextColor:function(a,b){this.getSubsetOfMessages(b).each(function(){var b=$(this);b.css("color",a)})},getSubsetOfMessages:function(a){return a?this.messages.filter(function(){return $(this).is(a)}):this.messages},update:function(){this.messages=$(".message-bubble")},newMessage:function(a,b){var b=$.extend({after:null,append:!0,container:null,artificialDate:null,timestamp:!0,tail:!0,inReplyTo:null,reply:!1},b);"[object String]"==Object.prototype.toString.call(b.append)&&(b.container=$(b.append),b.append=!0);var c=$(this.messageBubbleHTML.replace("MESSAGE",a));if(b.timestamp){var d=(null!==b.artificialDate?new Date(b.artificialDate):new Date).getTime();c.attr("data-"+this.timestampKey,d),this.timestamp(c)}if(b.tail||c.addClass("no-tail"),b.reply&&c.addClass("reply"),b.inReplyTo&&(b.inReplyTo.hasClass("reply")?c.removeClass("reply"):c.addClass("reply")),b.after){var e=$(b.after);e.length>0&&c.insertAfter(e)}else if(b.before){var f=$(b.before);f.length>0&&c.insertBefore(f)}else if(this.automateDateSections&&b.timestamp&&this.messages.length>0){var g=Math.floor(new Date(c.data(this.timestampKey)).getTime()/864e5),h=this.messages.last(),i=Math.floor(new Date(h.data(this.timestampKey)).getTime()/864e5);if(g-i>=1){var j=h,k=h.closest(".message-bubble-date-section");k.length>0&&(j=k),this.makeQuickDateSection(c).insertAfter(j)}else c.insertAfter(h)}else{var l=b.container?$(b.container):this.container,m=l.children(b.append?":last-child":":first-child");m.hasClass("message-bubble-date-section")&&(l=m),c[b.append?"appendTo":"prependTo"](l)}return this.update(),c},add:function(a,b){return this.newMessage(a,b)},makeDateSection:function(a){var a=$.extend({startMessage:null,endMessage:null,messageCount:null,sectionHeadingDate:null,sectionHeadingTime:null},a),b=this.messages;a.startMessage=this.convertPossibleSelectorToIndexNumber(a.startMessage,b),a.endMessage?a.endMessage=this.convertPossibleSelectorToIndexNumber(a.endMessage,b)+1:a.messageCount&&(a.endMessage=startMessage+messageCount),a.endMessage||(a.endMessage=b.length);var c=b.slice(a.startMessage-1,a.endMessage);this.destroyOverlappingSections(c),c.wrapAll(this.messageDateSectionHTML);var d=c.parent(),e="<h3 class='message-bubble-heading'><span class='message-bubble-date'>";return e+=a.sectionHeadingDate?a.sectionHeadingDate:this.weekdayString(c.first().data(this.timestampKey)),e+="</span>",a.sectionHeadingTime?e+=" "+a.sectionHeadingTime:a.sectionHeadingDate||(e+=" "+this.formatDateString(c.first().data(this.timestampKey))),e+="</h3>",$(e).prependTo(d),d},makeQuickDateSection:function(a){var b=$(this.messageDateSectionHTML),c=a.first().data(this.timestampKey);return this.destroyOverlappingSections(a),a.appendTo(b),$("<h3 class='message-bubble-heading'><span class='message-bubble-date'>"+this.weekdayString(c)+"</span> "+this.formatDateString(c)+"</h3>").prependTo(b),b},destroyOverlappingSections:function(a){a.each(function(){var a=$(this),b=a.parent();b.hasClass("message-bubble-date-section")&&(b.children(".message-bubble-heading").remove(),a.unwrap())})},convertPossibleSelectorToIndexNumber:function(a,b){return a?"number"!=typeof a&&("[object String]"==Object.prototype.toString.call(a)&&(a=$(a)),a=b.index(a),0>a)?null:a:null},removeMessage:function(a){var b=0,c=this.getSubsetOfMessages(a),d=this;b=c.length,c.each(function(){d.checkForSectionRemovalAndRemove($(this))});var e;return 1>b&&$(".message-bubble").each(function(){e=$(this),e.text().match(a)&&(d.checkForSectionRemovalAndRemove(e),b++)}),this.update(),b},remove:function(a){return this.removeMessage(a)},"delete":function(a){return this.removeMessage(a)},checkForSectionRemovalAndRemove:function(a){a.parent().hasClass("message-bubble-date-section")&&a.siblings(".message-bubble").length<1?a.parent().remove():a.remove()},timestamp:function(a){var b=a instanceof jQuery?a:this.getSubsetOfMessages(a),c=this;b.each(function(){var a=$(this),b=a.data(c.timestampKey);new Date(b),b&&!(new Date(b)+"").match(/Invalid/gi)&&a.append("<span class='message-bubble-timestamp'>"+c.formatDateString(b)+"</span>")})},formatDateString:function(a){a=new Date(a);var b=a.getHours(),c=a.getMinutes(),d=b%12!=0?b%12:12;return d+":"+(10>c?"0"+c:c)+" "+(b>=12?"PM":"AM")},weekdayString:function(a){a=new Date(a);var b=new Date;if(a.getYear()==b.getYear()&&a.getMonth()==b.getMonth()&&a.getDay()==b.getDay())return"Today";var c;switch(a.getDay()){case 0:c="Sunday";break;case 1:c="Monday";break;case 2:c="Tuesday";break;case 3:c="Wednesday";break;case 4:c="Thursday";break;case 5:c="Friday";break;default:c="Saturday"}return c}},$(document).ready(function(){var a=new MessageController;a.timestamp(),a.add("Sample message 1");var b=a.add("Sample message 2"),c=a.add("Sample message 3",{inReplyTo:b,artificialDate:(new Date).getTime()+8e7});a.add("Sample message 4",{inReplyTo:c,artificialDate:(new Date).getTime()+16e7}),a.add("Sample message 5",{reply:!0,artificialDate:(new Date).getTime()+166e6});var d=$(".message-bubble-container"),e=$(".message-bubble-timestamp").first().outerWidth();d.on("dragstart",function(){$(".message-bubble").removeClass("return")}),d.on("dragend",function(){$(".message-bubble").addClass("return").css("transform","translateX(0)"),$(".message-bubble-timestamp").css("opacity",0);var a=d.outerWidth()-parseFloat(d.css("padding-left"))-parseFloat(d.css("padding-right"));$(".message-bubble.reply").each(function(){var b=$(this);b.find(".message-bubble-timestamp").css("transform","translate("+(a-b.outerWidth())+"px, -50%)")})}),d.on("drag",function(a){$(".message-bubble:not(.reply)").css("transform","translateX("+Math.max(a.deltaX,-e)+"px)"),$(".message-bubble-timestamp").css("opacity",Math.max(0,a.deltaX/-e));var b=$(".message-bubble-container"),c=b.outerWidth()-parseFloat(b.css("padding-left"))-parseFloat(b.css("padding-right"));$(".message-bubble.reply").each(function(){var b=$(this);b.find(".message-bubble-timestamp").css("transform","translate("+(c-b.outerWidth()-Math.min(e,-a.deltaX))+"px, -50%)")})})});